<div class="container">
  <div class="row">
    <div class="col-lg-12">
      <h1 class="text-center">Part 1: Scraping data from DataSport</h1>

      <!-- Scraping section -->
      <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
          <div class="text_cell_render border-box-sizing rendered_html">
            <h1 id="DataSport-Scraping">DataSport Scraping</h1>
          </div>
        </div>
      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[1]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span> <span class="k">as</span> <span class="nn">rq</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="k">import</span> <span class="n">BeautifulSoup</span> <span class="k">as</span> <span class="n">bfs</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">ascii</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="k">import</span> <span class="n">urlparse</span>
</pre></div>

            </div>
          </div>
        </div>

      </div>
      <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
          <div class="text_cell_render border-box-sizing rendered_html">
            <h2 id="Scraping-a-table">Scraping a table</h2>
          </div>
        </div>
      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[2]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;iframe src=https://services.datasport.com/2016/lauf/lamara/alfaa.htm width=1000 height=350&gt;&lt;/iframe&gt;&#39;</span><span class="p">)</span>
</pre></div>

            </div>
          </div>
        </div>

        <div class="output_wrapper">
          <div class="output">


            <div class="output_area"><div class="prompt output_prompt">Out[2]:</div>

              <div class="output_html rendered_html output_subarea output_execute_result">
                <iframe src="https://services.datasport.com/2016/lauf/lamara/alfaa.htm" width="1000" height="350"></iframe>
              </div>

            </div>

          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[3]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_content</span><span class="p">(</span><span class="n">bfs_page</span><span class="p">):</span>
    <span class="n">fonts</span> <span class="o">=</span> <span class="n">bfs_page</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;pre &gt; font&#39;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="n">font</span><span class="o">.</span><span class="n">text</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_probability_of_split</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
    <span class="n">nb_blank</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">column</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
            <span class="n">nb_blank</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">prob_column</span> <span class="o">=</span> <span class="n">nb_blank</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">prob_column</span>

<span class="k">def</span> <span class="nf">split_separator</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">separator</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No probability given&#39;</span><span class="p">)</span>
    <span class="n">max_prob</span> <span class="o">=</span> <span class="n">probabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">probability</span> <span class="ow">in</span> <span class="n">probabilities</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">probability</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_prob</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">]:</span>
            <span class="n">max_prob</span> <span class="o">=</span> <span class="n">probability</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">max_prob</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="n">separator</span><span class="p">[:</span><span class="n">index</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">separator</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">separator</span>

<span class="k">def</span> <span class="nf">read_table</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">separator</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

    <span class="n">blank</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">header</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
            <span class="n">blank</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">new_prob</span> <span class="o">=</span> <span class="p">{{ '{' }}</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
            <span class="n">new_prob</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span>
            <span class="n">new_prob</span><span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_probability_of_split</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
            <span class="n">probabilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_prob</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">blank</span> <span class="ow">and</span> <span class="n">header</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
            <span class="n">blank</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">separator</span> <span class="o">=</span> <span class="n">split_separator</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
            <span class="n">probabilities</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">final_content</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">]</span> <span class="o">+</span> <span class="n">table</span>

    <span class="n">fill_values</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;-----&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)]</span>

    <span class="n">exclude_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;¦&#39;</span><span class="p">]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">final_content</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;fixed_width_two_line&#39;</span><span class="p">,</span> <span class="n">exclude_names</span><span class="o">=</span><span class="n">exclude_names</span><span class="p">,</span> <span class="n">fill_values</span><span class="o">=</span><span class="n">fill_values</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">add_acodes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">soup</span><span class="p">,</span> <span class="n">check_names</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">runners</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{{ '{' }}</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;myds&#39;</span><span class="p">})</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">runners</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No acode to add&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="c1"># Slow but we are sure that the acode match the runner</span>
    <span class="k">if</span> <span class="n">check_names</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;acode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">runner</span> <span class="ow">in</span> <span class="n">runners</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;nom&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">runner</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s1">&#39;acode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">runner</span><span class="p">[</span><span class="s1">&#39;acode&#39;</span><span class="p">]</span>

    <span class="c1"># Very fast but strong assumption on the order of the dataframe and the acodes find</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">acodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">runner</span><span class="p">[</span><span class="s1">&#39;acode&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">runner</span> <span class="ow">in</span> <span class="n">runners</span><span class="p">]</span>
        <span class="c1"># Need to add an extra acode for the last line</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;acode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">acodes</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">read_page</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">acodes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">rq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">bfs</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html5lib&#39;</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">get_content</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">acodes</span> <span class="ow">and</span> <span class="n">acodes</span> <span class="o">==</span> <span class="s1">&#39;no-check&#39;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">add_acodes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">soup</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">acodes</span> <span class="ow">and</span> <span class="n">acodes</span> <span class="o">==</span> <span class="s1">&#39;check&#39;</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">add_acodes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">soup</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

            </div>
          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[4]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">read_page</span><span class="p">(</span><span class="s1">&#39;https://services.datasport.com/2016/lauf/lamara/alfaa.htm&#39;</span><span class="p">,</span> <span class="s1">&#39;no-check&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

            </div>
          </div>
        </div>

        <div class="output_wrapper">
          <div class="output">


            <div class="output_area"><div class="prompt output_prompt">Out[4]:</div>

              <div class="output_html rendered_html output_subarea output_execute_result">
                <div>
                  <table border="1" class="dataframe">
                    <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>catégorie</th>
                      <th>rang</th>
                      <th>nom</th>
                      <th>an</th>
                      <th>lieu</th>
                      <th>équipe</th>
                      <th>pénalité</th>
                      <th>temps</th>
                      <th>retard</th>
                      <th>doss</th>
                      <th>overall</th>
                      <th>moyenne</th>
                      <th>acode</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                      <th>0</th>
                      <td>21-H50</td>
                      <td>147.</td>
                      <td>Abaidia Jilani</td>
                      <td>1966</td>
                      <td>St-Légier-La Chiésaz</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1:45.28,4</td>
                      <td>25.56,8</td>
                      <td>(5082)</td>
                      <td>diplôme foto video  21-Hom</td>
                      <td>1241.    4.59</td>
                      <td>1KSQJLYCM</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>21-D40</td>
                      <td>81.</td>
                      <td>Abaidia Sandrine</td>
                      <td>1972</td>
                      <td>St-Légier</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1:49.40,8</td>
                      <td>24.09,5</td>
                      <td>(5080)</td>
                      <td>diplôme foto video  21-Fem</td>
                      <td>289.     5.11</td>
                      <td>J2R2H9J5F</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>M-Fille3</td>
                      <td>33.</td>
                      <td>Abaidia Selma</td>
                      <td>2006</td>
                      <td>St-Légier-La Chiésaz</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>7.12,2</td>
                      <td>1.36,3</td>
                      <td>(22010)</td>
                      <td>diplôme foto video  ---</td>
                      <td>4.48</td>
                      <td>T4HUZEMR7</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>10W-NW</td>
                      <td>NaN</td>
                      <td>Abansir Florence</td>
                      <td>1971</td>
                      <td>Lausanne</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1:28.29,2</td>
                      <td>NaN</td>
                      <td>(18024)</td>
                      <td>diplôme foto video  ---</td>
                      <td>8.50</td>
                      <td>73E4NWC9K</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>21-H60</td>
                      <td>103.</td>
                      <td>Abb Jochen</td>
                      <td>1948</td>
                      <td>Ernen</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>2:50.40,7</td>
                      <td>1:21.28,7</td>
                      <td>(8381)</td>
                      <td>diplôme foto video  21-Hom</td>
                      <td>2921.    8.05</td>
                      <td>X7U8LH7Y1</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>

            </div>

          </div>
        </div>

      </div>
      <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
          <div class="text_cell_render border-box-sizing rendered_html">
            <h2 id="Scraping-a-run">Scraping a run</h2>
          </div>
        </div>
      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[5]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;iframe src=https://services.datasport.com/2016/lauf/lamara/ width=1000 height=350&gt;&lt;/iframe&gt;&#39;</span><span class="p">)</span>
</pre></div>

            </div>
          </div>
        </div>

        <div class="output_wrapper">
          <div class="output">


            <div class="output_area"><div class="prompt output_prompt">Out[5]:</div>

              <div class="output_html rendered_html output_subarea output_execute_result">
                <iframe src="https://services.datasport.com/2016/lauf/lamara/" width="1000" height="350"></iframe>
              </div>

            </div>

          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[6]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_all_data_from_page</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">rq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">bfs</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html5lib&#39;</span><span class="p">)</span>

    <span class="n">table_links</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;font &gt; a[href*=ALF]&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_links</span><span class="p">):</span>
        <span class="n">full_link</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">link</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table_links</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; - Processing &#39;</span> <span class="o">+</span> <span class="n">full_link</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">read_page</span><span class="p">(</span><span class="n">full_link</span><span class="p">,</span> <span class="s1">&#39;no-check&#39;</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">W_OK</span><span class="p">):</span>
            <span class="n">url_parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">full_link</span><span class="p">)</span>
            <span class="n">file</span> <span class="o">=</span> <span class="n">url_parsed</span><span class="o">.</span><span class="n">netloc</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url_parsed</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span>
            <span class="k">if</span> <span class="n">directory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
                <span class="n">file</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">file</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">file</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Write file: &#39;</span> <span class="o">+</span> <span class="n">file</span><span class="p">)</span>

        <span class="c1">#time.sleep(random.uniform(0, 0.5))</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

            </div>
          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[7]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">get_all_data_from_page</span><span class="p">(</span><span class="s1">&#39;https://services.datasport.com/2016/lauf/lamara/&#39;</span><span class="p">,</span> <span class="s1">&#39;./Data/Lausanne_Marathon_2016&#39;</span><span class="p">)</span>
</pre></div>

            </div>
          </div>
        </div>

        <div class="output_wrapper">
          <div class="output">


            <div class="output_area"><div class="prompt"></div>
              <div class="output_subarea output_stream output_stdout output_text">
<pre>1/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAA.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAA.HTM.csv
2/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAB.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAB.HTM.csv
3/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAC.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAC.HTM.csv
4/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAD.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAD.HTM.csv
5/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAE.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAE.HTM.csv
6/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAF.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAF.HTM.csv
7/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAG.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAG.HTM.csv
8/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAH.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAH.HTM.csv
9/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAI.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAI.HTM.csv
10/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAJ.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAJ.HTM.csv
11/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAK.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAK.HTM.csv
12/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAL.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAL.HTM.csv
13/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAM.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAM.HTM.csv
14/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAN.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAN.HTM.csv
15/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAO.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAO.HTM.csv
16/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAP.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAP.HTM.csv
17/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAQ.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAQ.HTM.csv
18/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAR.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAR.HTM.csv
19/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAS.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAS.HTM.csv
20/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAT.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAT.HTM.csv
21/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAU.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAU.HTM.csv
22/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAV.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAV.HTM.csv
23/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAW.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAW.HTM.csv
24/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAX.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAX.HTM.csv
25/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAY.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAY.HTM.csv
26/26 - Processing https://services.datasport.com/2016/lauf/lamara/ALFAZ.HTM
Write file: ./Data/Lausanne_Marathon_2016/services.datasport.com_2016_lauf_lamara_ALFAZ.HTM.csv
</pre>
              </div>
            </div>

          </div>
        </div>

      </div>

      <!-- Cleaning section -->
      <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
          <div class="text_cell_render border-box-sizing rendered_html">
            <h1 id="Clean-every-dataframes-and-merge">Clean every dataframes and merge</h1>
          </div>
        </div>
      </div>
      <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
          <div class="text_cell_render border-box-sizing rendered_html">
            <h2 id="Marathon-Lausanne-2016">Marathon Lausanne 2016</h2>
          </div>
        </div>
      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[3]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">clean_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;catégorie&#39;</span><span class="p">,</span> <span class="s1">&#39;rang&#39;</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">,</span> <span class="s1">&#39;an&#39;</span><span class="p">,</span> <span class="s1">&#39;lieu&#39;</span><span class="p">,</span> <span class="s1">&#39;équipe&#39;</span><span class="p">,</span> <span class="s1">&#39;pénalité&#39;</span><span class="p">,</span> <span class="s1">&#39;temps&#39;</span><span class="p">,</span> <span class="s1">&#39;retard&#39;</span><span class="p">,</span> <span class="s1">&#39;acode&#39;</span><span class="p">],</span> <span class="n">to_numeric_column</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rang&#39;</span><span class="p">,</span> <span class="s1">&#39;pénalité&#39;</span><span class="p">]):</span>

    <span class="c1"># Drop last row</span>
    <span class="n">dataframe</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="n">fields</span><span class="p">]</span>

    <span class="c1"># Parse column in numeric</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">to_numeric_column</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>

        <span class="c1"># Fix issue in overall and moyenne columns</span>
        <span class="k">if</span> <span class="s1">&#39;overall&#39;</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="c1"># Split last column</span>
            <span class="n">split</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">moyenne</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;. &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;moyenne&#39;</span> <span class="ow">in</span> <span class="n">fields</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;overall&#39;</span><span class="p">,</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;moyenne&#39;</span><span class="p">,</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;overall&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

        <span class="c1"># Remove () in doss column</span>
        <span class="k">if</span> <span class="s1">&#39;doss&#39;</span> <span class="ow">in</span> <span class="n">fields</span> <span class="ow">and</span>  <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">doss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">doss</span><span class="p">)[</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">doss</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;)&#39;</span><span class="p">:</span>
            <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;doss&#39;</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">doss</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Parse time</span>
        <span class="k">if</span> <span class="s1">&#39;temps&#39;</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;temps&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">temps</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%H:%M.%S,</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;temps&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">temps</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%M.%S,</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;retard&#39;</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;retard&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">retard</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%H:%M.%S,</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;retard&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">retard</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%M.%S,</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;an&#39;</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">dataframe</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;an&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">an</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y.0&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">dataframe</span>
</pre></div>

            </div>
          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[7]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Read and clean: &#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">uncleaned_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_dataframe</span><span class="p">(</span><span class="n">uncleaned_df</span><span class="p">))</span>
</pre></div>

            </div>
          </div>
        </div>

        <div class="output_wrapper">
          <div class="output">


            <div class="output_area"><div class="prompt"></div>
              <div class="output_subarea output_stream output_stdout output_text">
<pre>Read and clean: services.datasport.com_2016_lauf_lamara_ALFAW.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAN.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAR.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAC.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAH.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAK.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAU.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAP.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAI.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAY.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAJ.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAO.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAD.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAL.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAB.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAS.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAM.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAE.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAZ.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAV.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAQ.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAX.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAG.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAA.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAT.HTM.csv
Read and clean: services.datasport.com_2016_lauf_lamara_ALFAF.HTM.csv
</pre>
              </div>
            </div>

          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[8]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

            </div>
          </div>
        </div>

        <div class="output_wrapper">
          <div class="output">


            <div class="output_area"><div class="prompt output_prompt">Out[8]:</div>

              <div class="output_html rendered_html output_subarea output_execute_result">
                <div>
                  <table border="1" class="dataframe">
                    <thead>
                    <tr style="text-align: right;">
                      <th></th>
                      <th>catégorie</th>
                      <th>rang</th>
                      <th>nom</th>
                      <th>an</th>
                      <th>lieu</th>
                      <th>équipe</th>
                      <th>pénalité</th>
                      <th>temps</th>
                      <th>retard</th>
                      <th>acode</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                      <th>0</th>
                      <td>10-H40</td>
                      <td>285.0</td>
                      <td>Waardenburg George</td>
                      <td>NaT</td>
                      <td>Lausanne</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1900-01-01 00:50:26.600000</td>
                      <td>1900-01-01 00:18:48.900000</td>
                      <td>CPQP6ZGUB</td>
                    </tr>
                    <tr>
                      <th>1</th>
                      <td>10-JunG</td>
                      <td>186.0</td>
                      <td>Waeber Jean</td>
                      <td>NaT</td>
                      <td>Romont FR</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1900-01-01 00:53:10.800000</td>
                      <td>1900-01-01 00:20:29.600000</td>
                      <td>X4HC5EYRT</td>
                    </tr>
                    <tr>
                      <th>2</th>
                      <td>10-D50</td>
                      <td>17.0</td>
                      <td>Waeber Marie-Jo</td>
                      <td>NaT</td>
                      <td>Pully</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1900-01-01 00:48:47.500000</td>
                      <td>1900-01-01 00:07:53.500000</td>
                      <td>HAP8H6A7Q</td>
                    </tr>
                    <tr>
                      <th>3</th>
                      <td>21-H30</td>
                      <td>778.0</td>
                      <td>Waeber Pascal</td>
                      <td>NaT</td>
                      <td>Chernex</td>
                      <td>NaN</td>
                      <td>NaN</td>
                      <td>1900-01-01 02:03:58.500000</td>
                      <td>1900-01-01 00:55:30.600000</td>
                      <td>ZT9BYS5M3</td>
                    </tr>
                    <tr>
                      <th>4</th>
                      <td>21-D40</td>
                      <td>11.0</td>
                      <td>Waeber Yvette</td>
                      <td>NaT</td>
                      <td>Romont FR</td>
                      <td>NaN</td>
                      <td>5.0</td>
                      <td>1900-01-01 01:34:50.700000</td>
                      <td>1900-01-01 00:09:19.400000</td>
                      <td>2T9WCSAM7</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>

            </div>

          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[9]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./Data/Lausanne_Marathon_2016.csv&#39;</span><span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;./Data/Lausanne_Marathon_2016.pickle&#39;</span><span class="p">)</span>
</pre></div>

            </div>
          </div>
        </div>

      </div>
      <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
          <div class="prompt input_prompt">In&nbsp;[10]:</div>
          <div class="inner_cell">
            <div class="input_area">
              <div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head <span class="s1">&#39;./Data/Lausanne_Marathon_2016.csv&#39;</span>
</pre></div>

            </div>
          </div>
        </div>

        <div class="output_wrapper">
          <div class="output">


            <div class="output_area"><div class="prompt"></div>
              <div class="output_subarea output_stream output_stdout output_text">
<pre>,catégorie,rang,nom,an,lieu,équipe,pénalité,temps,retard,acode
0,10-H40,285.0,Waardenburg George,,Lausanne,,,1900-01-01 00:50:26.600000,1900-01-01 00:18:48.900000,CPQP6ZGUB
1,10-JunG,186.0,Waeber Jean,,Romont FR,,,1900-01-01 00:53:10.800000,1900-01-01 00:20:29.600000,X4HC5EYRT
2,10-D50,17.0,Waeber Marie-Jo,,Pully,,,1900-01-01 00:48:47.500000,1900-01-01 00:07:53.500000,HAP8H6A7Q
3,21-H30,778.0,Waeber Pascal,,Chernex,,,1900-01-01 02:03:58.500000,1900-01-01 00:55:30.600000,ZT9BYS5M3
4,21-D40,11.0,Waeber Yvette,,Romont FR,,5.0,1900-01-01 01:34:50.700000,1900-01-01 00:09:19.400000,2T9WCSAM7
5,21-H20,495.0,Waechter Loïc,,Corsier GE,CP des pompiers de Corsier,,1900-01-01 02:01:52.300000,1900-01-01 00:53:19.100000,FR1Z38K3W
6,42-H30,185.0,Wäckerlin David,,Yverdon-les-Bains,,,1900-01-01 03:49:16.400000,1900-01-01 01:32:10.200000,FFGG7UNAD
7,21-JunG,55.0,Wada Masaki,,Leysin,KLAS,,1900-01-01 02:02:55,1900-01-01 00:43:35.400000,CSJGL5UXF
8,42-H30,230.0,Waddington Thomas,,Le Châble VS,,,1900-01-01 04:00:39.100000,1900-01-01 01:43:32.900000,Z7USXH5Y8
</pre>
              </div>
            </div>

          </div>
        </div>

      </div>

    </div>
  </div>
</div>
